# Reproducibility

## Environment
- Create env:
  micromamba env create -f environment/environment.yml
- Activate:
  micromamba activate geo

## Run pipeline

The main reproducible pipeline includes:

1. **QC spatial sanity checks**:
```bash
python scripts/01_verify_spatial_data.py
```

2. **Generate static report figure** (overview + inset with price quantiles):
```bash
python scripts/02_make_static_map_overview_inset.py
```

3. **Full end-to-end ETL** (cleaning, enrichment, spatial joins, aggregation):
```bash
jupyter notebook notebooks/05_final_pipeline.ipynb
```

### Inputs & Outputs

**Inputs** (assumed to be in `data/original/`):
- `calendar.csv`, `listings.csv`, `reviews.csv`, `neighbourhoods.geojson`

**Outputs**:
- Processed datasets: `data/processed/*.parquet`, `data/processed/*.geojson`
- Static report figures: **`reports/figures/*.png`** (unified location)

## Notes
- Distances/areas must be computed in a projected CRS (meters), not EPSG:4326.
- Always check CRS, geometry validity, missing values and outliers.

### Data management for reproducibility
- Raw InsideAirbnb files (e.g., `calendar.csv`, `reviews.csv`, `listings.csv`) are not tracked in git due to size/licensing; place them locally in `data/original/`.
- The project is fully reproducible: all processed datasets in `data/processed/` can be regenerated by running the pipeline scripts/notebooks.
- Small web-ready artifacts (e.g., `data/processed/neighbourhoods_enriched.geojson` and `data/processed/listings_points_enriched_sample.geojson`) may be tracked to support fast webmap rendering.
- Final report figures are stored in `reports/figures/`.
